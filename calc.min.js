const f=[[[[1,1],[1,1]]],[[[2,2,2,2]],[[2],[2],[2],[2]]],[[[3,3,0],[0,3,3]],[[0,3],[3,3],[3,0]]],[[[0,4,4],[4,4,0]],[[4,0],[4,4],[0,4]]],[[[5,0,0],[5,5,5]],[[5,5],[5,0],[5,0]],[[5,5,5],[0,0,5]],[[0,5],[0,5],[5,5]]],[[[0,0,6],[6,6,6]],[[6,6],[0,6],[0,6]],[[6,6,6],[6,0,0]],[[6,0],[6,0],[6,6]]],[[[0,7,0],[7,7,7]],[[7,7,7],[0,7,0]],[[7,0],[7,7],[7,0]],[[0,7],[7,7],[0,7]]],[[[0,8,0],[8,8,8],[0,8,0]]],[[[9]]],[[[10,10]],[[10],[10]]],[[[11,11],[11,0]],[[11,11],[0,11]],[[0,11],[11,11]],[[11,0],[11,11]]]];let g,h,k,l,m;function p(d,c,b,a){b=f[b][a];for(a=0;!b[0][a];)++a;c-=a;if(0>c)return!1;for(a=0;a<b.length;++a)for(let e=0;e<b[0].length;++e)if(b[a][e]&&(d+a>=g||c+e>=h||-1!==k[d+a][c+e]))return!1;return!0}function q(d,c,b,a,e){b=f[b][a];for(a=0;!b[0][a];)++a;c-=a;for(a=0;a<b.length;++a)for(let n=0;n<b[0].length;++n)b[a][n]&&(k[d+a][c+n]=e)}function r(d){if(d===g*h){d=Array(g);for(var c=0;c<g;++c)d[c]=k[c].map(a=>a);m.push(d);return 1E4<=m.length?!0:!1}c=Math.floor(d/h);const b=d%h;if(-1!==k[c][b])return r(d+1)?!0:!1;for(let a=0;a<f.length;++a)if(l[a])for(let e=0;e<f[a].length;++e)if(p(c,b,a,e)){q(c,b,a,e,a+1);--l[a];if(r(d+1))return!0;++l[a];q(c,b,a,e,-1)}return!1}function Solve(d,c){m=[];g=d.length;h=d[0].length;k=Array(g);for(let b=0;b<g;++b)k[b]=d[b].map(a=>a);l=c.map(b=>b);r(0);return m}
